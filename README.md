# douban_movie

### 使用依赖
框架 scrapy\
去重数据库 redis\
储存数据库 mongodb 或 mysql\
数据库 mysql或mongodb\
必须实现高匿名代理池\
这里有一个简单的参考 https://github.com/txf19920101/proxy_pool

### 使用方式
需要先填写settings的 数据库配置信息 以及redis.py 的redis 配置信息\
然后运行utils.py 进行生成请求url\
然后直接scrapy crawl movie 进行抓取 大概也就100秒左右的时间就完事了\
前提是代理数量充足,并且可用

### utils.py
利用二分查找算法实现了简单的分类最大值查找, 我已经将最大值复制到文件当中了\
如果需要再找一次,直接取消文件中的注释即可 需要安装requests

### 其他
剩下的就是简单的请求,解析,然后存库之类的操作.\
去重主要是利用了redis 集合的特性\
插入数据使用的是多条插入,主要减少了与数据库的频繁交互\
有一点点小bug，就是不知道啥时候抽个风插入失败,会导致丢失一次插入的数据\
由于失败几率太小,导致难以调试\
如果对数据的完整性需求较高可以改成 单条插入 或者 更新插入的方式\
如果使用mongodb做储存数据库需要在item.py 当中定义一个 _id 字段 值不用管,mysql不用
